# DNA Snakemake Proto-Workflow

This repository is based on the [Snakemake tutorial](http://snakemake.readthedocs.io/en/latest/tutorial/welcome.html) and [PaneucalyptShortReads](https://github.com/kdmurray91/PaneucalyptShortReads)


 <img src="https://divingintogeneticsandgenomics.rbind.io/img/snakemake.png" alt="Girl in a jacket" width="200" height="150">  


## [Setup](https://snakemake.readthedocs.io/en/stable/tutorial/setup.html)

The easiest way to setup these prerequisites is to use the **Miniconda** Python 3 distribution.

```
$ wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
$ bash Miniconda3-latest-Linux-x86_64.sh
```

**Creating an environment with the required software**

```
$ conda env create --name snakemake-tutorial --file condaenv.yml
```

**Activate the enviroment using:**

```
$ conda activate snakemake-tutorial
```

**Check enviroments**
```
conda info --envs
```

**Delete enviroment**
```
conda remove --name myenv --all
```

## Reproduce results

> NOTE: the ```data``` directory is generated by the workflow (*common* rule).

get **dag.svg** and check rules (see ```--dag -npr```)

```
snakemake --dag -npr -j -1 | dot -Tsvg > dag.svg
eog dag.svg
```

**Run complete Workflow**

```
snakemake  -npr -j -1
```


### Check config and metadata

```utils/check_config.py``` allows you to read and print the config files:

```
from utils.check_config import *
config = readconfig('config.yml')
pconfig(config)
config['qc']
```


```utils/check_metadata.py``` allows you to print the metadata generated at the ```common``` rule:

```
python utils/check_metadata.py
```
